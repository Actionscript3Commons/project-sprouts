require 'test_helper'
require 'fixtures/executable/fdb'

class DaemonTest < Test::Unit::TestCase
  include SproutTestCase

  context "a new daemon delegate" do

    setup do
      @fdb      = Sprout::FDB.new
      @fdb_fake = File.join(fixtures, 'executable', 'flex3sdk_gem', 'fdb')
      # Execute the fake executable:
      response  = OpenStruct.new(:path => @fdb_executable)
      Sprout::Executable.expects(:load).with(:fdb, 'flex4sdk', '>= 1.0.0.pre').returns response
    end

    should "instantiate" do
      assert_not_nil @fdb
    end

    should "execute without shell params" do
      @fdb.stubs(:binary_path).returns("fdb")
      @fdb.expects(:to_shell).returns("fdb")
      @fdb.expects(:system_execute)
      @fdb.execute
    end

    should "wait for prompt" do
      @fdb.execute
    end
  end
end

