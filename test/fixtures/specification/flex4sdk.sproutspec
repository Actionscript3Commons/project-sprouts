
# This is just a custom Ruby method that will be
# available to this file so that we can share
# configuration for two different remote file
# targets.
def configure_file_target t, add_suffix=false
  # Remote Archive:
  t.archive_type = :zip
  t.url          = "http://download.macromedia.com/pub/labs/flex/4/flex4sdk_b2_100509.zip"
  t.md5          = "6a0838c5cb33145fe88933778ddb966d"

  exe_suffix = (add_suffix) ? '.exe' : ''

  # Executables: (add .exe suffix if it was passed in)
  t.add_executable :aasdoc,     "bin/aasdoc#{exe_suffix}"
  t.add_executable :acompc,     "bin/acompc#{exe_suffix}"
  t.add_executable :adl,        "bin/adl#{exe_suffix}"
  t.add_executable :adt,        "bin/adt#{exe_suffix}"
  t.add_executable :amxmlc,     "bin/amxmlc#{exe_suffix}"
  t.add_executable :asdoc,      "bin/asdoc#{exe_suffix}"
  t.add_executable :compc,      "bin/compc#{exe_suffix}"
  t.add_executable :copylocale, "bin/compc#{exe_suffix}"
  t.add_executable :digest,     "bin/digest#{exe_suffix}"
  t.add_executable :fcsh,       "bin/fcsh#{exe_suffix}"
  t.add_executable :fdb,        "bin/fdb#{exe_suffix}"
  t.add_executable :mxmlc,      "bin/mxmlc#{exe_suffix}"
  t.add_executable :optimizer,  "bin/optimizer#{exe_suffix}"

  # Flex framework SWCs:
  t.add_library :flex,            "frameworks/libs/flex.swc"
  t.add_library :flex4,           "frameworks/libs/flex4.swc"
  t.add_library :f_textlayout,    "frameworks/libs/framework_textLayout.swc"
  t.add_library :framework,       "frameworks/libs/framework.swc"
  t.add_library :rpc,             "frameworks/libs/rpc.swc"
  t.add_library :sparkskins,      "frameworks/libs/sparkskins.swc"
  t.add_library :textlayout,      "frameworks/libs/textLayout.swc"
  t.add_library :utilities,       "frameworks/libs/utilities.swc"
  t.add_library :playerglobal_9,  "frameworks/libs/player/9/playerglobal.swc"
  t.add_library :playerglobal_10, "frameworks/libs/player/10/playerglobal.swc"

  # AsDoc templates:
  t.add_library :asdoc_templates, "asdoc/templates"

  # Locale-Specific Flex SWCs:
  [
    'da_DK', 'de_DE', 'en_US', 'es_ES', 'fi_FL', 'fr_FR', 'it_IT', 'ja_JP', 
    'ko_KR', 'nb_NO', 'nl_NL', 'pt_BR', 'ru_RU', 'sv_SE', 'zh_CN', 'zh_TW'
  ].each do |locale|
    t.add_library "flex_4_#{locale}".to_sym,       "frameworks/locale/#{locale}/flex4_rb.swc"
    t.add_library "airframework_#{locale}".to_sym, "frameworks/locale/#{locale}/airframework_rb.swc"
    t.add_library "framework_#{locale}".to_sym,    "frameworks/locale/#{locale}/framework_rb.swc"
    t.add_library "rpc_#{locale}".to_sym,          "frameworks/locale/#{locale}/rpc_rb.swc"
  end
end

# Create the Sprout Specification here:
Sprout::Specification.new do |s|
  s.name        = "flex4sdk"
  s.version     = "4.0.pre"
  #s.author      = "Adobe, Inc."
  #s.email       = "projectsprouts@googlegroups.com"
  #s.homepage    = "http://www.adobe.com/products/flex"
  #s.summary     = "Adobe Flex 4 SDK including mxmlc, compc, asdoc, adl, adt, optimizer and fdb"
  #s.description = "The Flex 4 SDK Rubygem is brought to you by Project Sprouts (http://projectsprouts.org)"

  # Windows users need to reference a different set
  # of executables from everyone else (.exe):
  #
  # This declaration needs to be before the :universal
  # platform support, because the first viable match
  # will be used.
  s.add_remote_file_target do |t|
    # Apply the windows-specific configuration:
    t.platform = :win32
    # Apply the shared platform configuration:
    configure_file_target t, true
  end

  # All other platforms will simply refer to the 
  # non-exe binaries:
  s.add_remote_file_target do |t|
    # Apply the non-windows configuration:
    t.platform     = :universal
    # Apply the shared platform configuration:
    configure_file_target t
  end
end

