<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Sprout::FlashPlayerTask</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Sprout::FlashPlayerTask</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/bundles/flashplayer/lib/sprout/tasks/flashplayer_task_rb.html">
                bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Rake::Task
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
The <a href="FlashPlayerTask.html">FlashPlayerTask</a> will download,
unpack, configure and launch the debug Flash Player for OS X, Windows and
Linux.
</p>
<p>
Simply send the rake task the <tt><a
href="FlashPlayerTask.html#M000305">swf</a></tt> you&#8216;d like to launch
either indirectly as a rake dependency or directly as the <tt><a
href="FlashPlayerTask.html#M000305">swf</a></tt> property of this task.
</p>
<pre>
  flashplayer :run =&gt; 'bin/SomeProject.swf'
</pre>
<p>
Or you could:
</p>
<pre>
  flashplayer :run do |t|
    t.swf = 'bin/SomeProject.swf'
  end
</pre>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000316">close</a>&nbsp;&nbsp;
      <a href="#M000300">define_task</a>&nbsp;&nbsp;
      <a href="#M000307">do_not_focus</a>&nbsp;&nbsp;
      <a href="#M000306">do_not_focus=</a>&nbsp;&nbsp;
      <a href="#M000322">examine_test_result</a>&nbsp;&nbsp;
      <a href="#M000315">execute</a>&nbsp;&nbsp;
      <a href="#M000318">focus_player_on_mac</a>&nbsp;&nbsp;
      <a href="#M000311">gem_name</a>&nbsp;&nbsp;
      <a href="#M000310">gem_name=</a>&nbsp;&nbsp;
      <a href="#M000309">gem_version</a>&nbsp;&nbsp;
      <a href="#M000308">gem_version=</a>&nbsp;&nbsp;
      <a href="#M000302">home</a>&nbsp;&nbsp;
      <a href="#M000303">home_paths</a>&nbsp;&nbsp;
      <a href="#M000299">new</a>&nbsp;&nbsp;
      <a href="#M000320">parse_test_result</a>&nbsp;&nbsp;
      <a href="#M000319">read_log</a>&nbsp;&nbsp;
      <a href="#M000317">run</a>&nbsp;&nbsp;
      <a href="#M000305">swf</a>&nbsp;&nbsp;
      <a href="#M000304">swf=</a>&nbsp;&nbsp;
      <a href="#M000314">test_result</a>&nbsp;&nbsp;
      <a href="#M000313">test_result_file</a>&nbsp;&nbsp;
      <a href="#M000312">test_result_file=</a>&nbsp;&nbsp;
      <a href="#M000301">trust</a>&nbsp;&nbsp;
      <a href="#M000321">write_test_result</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000300" class="method-detail">
        <a name="M000300"></a>

        <div class="method-heading">
          <a href="#M000300" class="method-signature">
          <span class="method-name">define_task</span><span class="method-args">(args) {|t if block_given?| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000300-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000300-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 72</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">define_task</span>(<span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
      <span class="ruby-identifier">t</span> = <span class="ruby-keyword kw">super</span>
      <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">t</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
      <span class="ruby-identifier">t</span>.<span class="ruby-identifier">define</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000302" class="method-detail">
        <a name="M000302"></a>

        <div class="method-heading">
          <a href="#M000302" class="method-signature">
          <span class="method-name">home</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Local system path to where the Flash Player stores trace output logs and <a
href="FlashPlayerTask.html#M000301">trust</a> files
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000302-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000302-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 88</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-constant">FlashPlayerTask</span>.<span class="ruby-identifier">home</span>
      <span class="ruby-keyword kw">if</span>(<span class="ruby-ivar">@@home</span>)
        <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@@home</span>
      <span class="ruby-keyword kw">end</span>

      <span class="ruby-constant">FlashPlayerTask</span>.<span class="ruby-identifier">home_paths</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span>
        <span class="ruby-keyword kw">if</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">path</span>))
          <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@@home</span> = <span class="ruby-identifier">path</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>

      <span class="ruby-keyword kw">if</span>(<span class="ruby-ivar">@@home</span>.<span class="ruby-identifier">nil?</span>)
        <span class="ruby-identifier">raise</span> <span class="ruby-constant">FlashPlayerError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'FlashPlayer unable to find home folder for your platform'</span>)
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@@home</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000303" class="method-detail">
        <a name="M000303"></a>

        <div class="method-heading">
          <a href="#M000303" class="method-signature">
          <span class="method-name">home_paths</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Collection of the potential locations of the Flash Player Home For each
supported Platform, the first existing location will be used.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000303-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000303-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 108</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-constant">FlashPlayerTask</span>.<span class="ruby-identifier">home_paths</span>
      <span class="ruby-keyword kw">return</span> [<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">User</span>.<span class="ruby-identifier">library</span>, <span class="ruby-value str">'Preferences'</span>, <span class="ruby-value str">'Macromedia'</span>, <span class="ruby-value str">'Flash Player'</span>),
              <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">User</span>.<span class="ruby-identifier">library</span>, <span class="ruby-value str">'Application Support'</span>, <span class="ruby-value str">'Macromedia'</span>),
              <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">User</span>.<span class="ruby-identifier">home</span>, <span class="ruby-value str">'Application Data'</span>, <span class="ruby-value str">'Macromedia'</span>, <span class="ruby-value str">'Flash Player'</span>),
              <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">User</span>.<span class="ruby-identifier">home</span>, <span class="ruby-value str">'.macromedia'</span>, <span class="ruby-value str">'Flash_Player'</span>)]
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000299" class="method-detail">
        <a name="M000299"></a>

        <div class="method-heading">
          <a href="#M000299" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(task_name, app)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000299-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000299-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 65</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">task_name</span>, <span class="ruby-identifier">app</span>)
      <span class="ruby-keyword kw">super</span>(<span class="ruby-identifier">task_name</span>, <span class="ruby-identifier">app</span>)
      <span class="ruby-ivar">@default_gem_name</span> = <span class="ruby-value str">'sprout-flashplayer-tool'</span>
      <span class="ruby-ivar">@default_result_file</span> = <span class="ruby-value str">'AsUnitResults.xml'</span>
      <span class="ruby-ivar">@inside_test_result</span> = <span class="ruby-keyword kw">false</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000301" class="method-detail">
        <a name="M000301"></a>

        <div class="method-heading">
          <a href="#M000301" class="method-signature">
          <span class="method-name">trust</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Local system path to the Flash Player Trust file
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000301-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000301-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 79</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-constant">FlashPlayerTask</span>.<span class="ruby-identifier">trust</span>
      <span class="ruby-keyword kw">if</span>(<span class="ruby-ivar">@@trust</span>)
        <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@@trust</span>
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-ivar">@@trust</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">FlashPlayerTask</span>.<span class="ruby-identifier">home</span>, <span class="ruby-value str">'#Security'</span>, <span class="ruby-value str">'FlashPlayerTrust'</span>, <span class="ruby-value str">'sprout.cfg'</span>)
      <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@@trust</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000316" class="method-detail">
        <a name="M000316"></a>

        <div class="method-heading">
          <a href="#M000316" class="method-signature">
          <span class="method-name">close</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000316-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000316-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 237</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">close</span>
      <span class="ruby-keyword kw">if</span>(<span class="ruby-constant">User</span>.<span class="ruby-identifier">new</span>().<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">WinUser</span>))
        <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">kill</span>(<span class="ruby-ivar">@thread</span>)
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-constant">Process</span>.<span class="ruby-identifier">kill</span>(<span class="ruby-value str">&quot;SIGALRM&quot;</span>, <span class="ruby-ivar">@player_pid</span>)
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000307" class="method-detail">
        <a name="M000307"></a>

        <div class="method-heading">
          <a href="#M000307" class="method-signature">
          <span class="method-name">do_not_focus</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000307-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000307-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 152</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_not_focus</span>
      <span class="ruby-ivar">@do_not_focus</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword kw">nil</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000306" class="method-detail">
        <a name="M000306"></a>

        <div class="method-heading">
          <a href="#M000306" class="method-signature">
          <span class="method-name">do_not_focus=</span><span class="method-args">(focus)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
By default, the Flash Player should be given focus after being launched.
Unfortunately, this doesn&#8216;t work properly on OS X, so we needed to do
some hackery in order to make it happen. This in turn can lead to multiple
instances of the Player being instantiated. In the case of running a test
harness, this is absolutely not desirable, so we had expose a parameter
that allows us to prevent auto-focus of the player.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000306-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000306-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 148</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_not_focus=</span>(<span class="ruby-identifier">focus</span>)
      <span class="ruby-ivar">@do_not_focus</span> = <span class="ruby-identifier">focus</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000322" class="method-detail">
        <a name="M000322"></a>

        <div class="method-heading">
          <a href="#M000322" class="method-signature">
          <span class="method-name">examine_test_result</span><span class="method-args">(result)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000322-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000322-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 332</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">examine_test_result</span>(<span class="ruby-identifier">result</span>)
      <span class="ruby-identifier">require</span> <span class="ruby-value str">'rexml/document'</span>
      <span class="ruby-identifier">doc</span> = <span class="ruby-keyword kw">nil</span>
      <span class="ruby-keyword kw">begin</span>
        <span class="ruby-identifier">doc</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">Document</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">result</span>)
      <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">ParseException</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
        <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;[WARNING] Invalid test results encountered&quot;</span>
        <span class="ruby-keyword kw">return</span>
      <span class="ruby-keyword kw">end</span>
      
      <span class="ruby-comment cmt"># Handle JUnit Failures</span>
      <span class="ruby-identifier">failures</span> = []

      <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">elements</span>.<span class="ruby-identifier">each</span>(<span class="ruby-value str">'/testsuites/testsuite/testsuite/testcase/error'</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">element</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">failures</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">element</span>.<span class="ruby-identifier">text</span>
      <span class="ruby-keyword kw">end</span>

      <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">elements</span>.<span class="ruby-identifier">each</span>(<span class="ruby-value str">&quot;/testsuites/testsuite/testsuite/testcase/failure&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">element</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">failures</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">element</span>.<span class="ruby-identifier">text</span>
      <span class="ruby-keyword kw">end</span>

      <span class="ruby-keyword kw">if</span>(<span class="ruby-identifier">failures</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
        <span class="ruby-identifier">raise</span> <span class="ruby-constant">AssertionFailure</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;[ERROR] Test Failures Encountered \n#{failures.join(&quot;\n&quot;)}&quot;</span>)
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000315" class="method-detail">
        <a name="M000315"></a>

        <div class="method-heading">
          <a href="#M000315" class="method-signature">
          <span class="method-name">execute</span><span class="method-args">(*args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000315-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000315-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 208</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">execute</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
      <span class="ruby-keyword kw">super</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">FlashPlayerError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;FlashPlayer task #{name} required field swf is nil&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">swf</span>
      
      <span class="ruby-identifier">log_file</span> = <span class="ruby-keyword kw">nil</span>

      <span class="ruby-comment cmt"># Don't let trust or log file failures break other features...</span>
      <span class="ruby-keyword kw">begin</span>
        <span class="ruby-identifier">log_file</span> = <span class="ruby-constant">FlashPlayerConfig</span>.<span class="ruby-identifier">new</span>().<span class="ruby-identifier">log</span>
        <span class="ruby-constant">FlashPlayerTrust</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">swf</span>)))

        <span class="ruby-keyword kw">if</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">log_file</span>))
          <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">log_file</span>, <span class="ruby-value str">'w'</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
            <span class="ruby-identifier">f</span>.<span class="ruby-identifier">write</span>(<span class="ruby-value str">''</span>)
          <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">else</span>
          <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">log_file</span>))
          <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">touch</span>(<span class="ruby-identifier">log_file</span>)
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">rescue</span>
        <span class="ruby-identifier">puts</span> <span class="ruby-value str">'[WARNING] FlashPlayer encountered an error working with the mm.cfg log and/or editing the Trust file'</span>
      <span class="ruby-keyword kw">end</span>
      
      <span class="ruby-ivar">@running_process</span> = <span class="ruby-keyword kw">nil</span>
      <span class="ruby-ivar">@thread</span> = <span class="ruby-identifier">run</span>(<span class="ruby-identifier">gem_name</span>, <span class="ruby-identifier">gem_version</span>, <span class="ruby-identifier">swf</span>)
      <span class="ruby-identifier">read_log</span>(<span class="ruby-ivar">@thread</span>, <span class="ruby-identifier">log_file</span>)
      <span class="ruby-ivar">@thread</span>.<span class="ruby-identifier">join</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000318" class="method-detail">
        <a name="M000318"></a>

        <div class="method-heading">
          <a href="#M000318" class="method-signature">
          <span class="method-name">focus_player_on_mac</span><span class="method-args">(out, exe)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000318-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000318-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 266</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">focus_player_on_mac</span>(<span class="ruby-identifier">out</span>, <span class="ruby-identifier">exe</span>)
      <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">do_not_focus</span>
      <span class="ruby-keyword kw">begin</span>
        <span class="ruby-keyword kw">if</span>(<span class="ruby-constant">User</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">OSXUser</span>))
          <span class="ruby-identifier">require</span> <span class="ruby-value str">'appscript'</span>
          <span class="ruby-constant">Appscript</span>.<span class="ruby-identifier">app</span>(<span class="ruby-identifier">exe</span>).<span class="ruby-identifier">activate</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">LoadError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
        <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;[WARNING] Cannot focus Flash Player without rb-appscript gem&quot;</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000311" class="method-detail">
        <a name="M000311"></a>

        <div class="method-heading">
          <a href="#M000311" class="method-signature">
          <span class="method-name">gem_name</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000311-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000311-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 185</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">gem_name</span>
      <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@gem_name</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@default_gem_name</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000310" class="method-detail">
        <a name="M000310"></a>

        <div class="method-heading">
          <a href="#M000310" class="method-signature">
          <span class="method-name">gem_name=</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Full name of the sprout tool gem that this tool task will use. This
defaults to sprout-flashplayer-tool
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000310-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000310-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 181</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">gem_name=</span>(<span class="ruby-identifier">name</span>)
      <span class="ruby-ivar">@gem_name</span> = <span class="ruby-identifier">name</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000309" class="method-detail">
        <a name="M000309"></a>

        <div class="method-heading">
          <a href="#M000309" class="method-signature">
          <span class="method-name">gem_version</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000309-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000309-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 175</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">gem_version</span>
      <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@gem_version</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword kw">nil</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000308" class="method-detail">
        <a name="M000308"></a>

        <div class="method-heading">
          <a href="#M000308" class="method-signature">
          <span class="method-name">gem_version=</span><span class="method-args">(version)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
The gem version of the sprout-flashplayer-tool RubyGem to download.
</p>
<p>
It&#8216;s important to note that this version number will differ slightly
from the actual player version in that the final revision (the last of
three numbers), is the gem version, while the first two describe the player
version being downloaded. The exact gem version that you would like the <a
href="ToolTask.html">ToolTask</a> to <a
href="FlashPlayerTask.html#M000315">execute</a>. By default this value
should be nil and will download the latest version of the gem that is
available unless there is a version already installed on your system.
</p>
<p>
This attribute could be an easy way to update your local gem to the latest
version without leaving your build file, but it&#8216;s primary purpose is
to allow you to specify very specific versions of the tools that your
project depends on. This way your team can rest assured that they are all
working with the same tools.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000308-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000308-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 171</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">gem_version=</span>(<span class="ruby-identifier">version</span>)
      <span class="ruby-ivar">@gem_version</span> = <span class="ruby-identifier">version</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000320" class="method-detail">
        <a name="M000320"></a>

        <div class="method-heading">
          <a href="#M000320" class="method-signature">
          <span class="method-name">parse_test_result</span><span class="method-args">(line, thread)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if inside of a test result
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000320-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000320-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 305</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_test_result</span>(<span class="ruby-identifier">line</span>, <span class="ruby-identifier">thread</span>)
      <span class="ruby-keyword kw">if</span>(<span class="ruby-ivar">@inside_test_result</span>)
        <span class="ruby-keyword kw">if</span>(<span class="ruby-identifier">line</span>.<span class="ruby-identifier">index</span>(<span class="ruby-ivar">@@test_result_post_delimiter</span>))
          <span class="ruby-ivar">@inside_test_result</span> = <span class="ruby-keyword kw">false</span>
          <span class="ruby-identifier">write_test_result</span>(<span class="ruby-identifier">test_result</span>)
          <span class="ruby-identifier">close</span>
          <span class="ruby-identifier">examine_test_result</span> <span class="ruby-identifier">test_result</span>
          <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
        <span class="ruby-keyword kw">else</span>
          <span class="ruby-identifier">test_result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>

      <span class="ruby-keyword kw">if</span>(<span class="ruby-identifier">line</span>.<span class="ruby-identifier">index</span>(<span class="ruby-ivar">@@test_result_pre_delimiter</span>))
        <span class="ruby-ivar">@inside_test_result</span> = <span class="ruby-keyword kw">true</span>
      <span class="ruby-keyword kw">end</span>
      
      <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@inside_test_result</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000319" class="method-detail">
        <a name="M000319"></a>

        <div class="method-heading">
          <a href="#M000319" class="method-signature">
          <span class="method-name">read_log</span><span class="method-args">(thread, log_file)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000319-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000319-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 278</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read_log</span>(<span class="ruby-identifier">thread</span>, <span class="ruby-identifier">log_file</span>)
      <span class="ruby-identifier">lines_put</span> = <span class="ruby-value">0</span>

      <span class="ruby-keyword kw">if</span>(<span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">log_file</span>))
        <span class="ruby-identifier">raise</span> <span class="ruby-constant">FlashPlayerError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'[ERROR] Unable to find the trace output log file in the expected location: '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">log_file</span>)
      <span class="ruby-keyword kw">end</span>

      <span class="ruby-keyword kw">while</span>(<span class="ruby-identifier">thread</span>.<span class="ruby-identifier">alive?</span>)
        <span class="ruby-identifier">sleep</span>(<span class="ruby-value">0</span><span class="ruby-value">.2</span>)
        <span class="ruby-identifier">lines_read</span> = <span class="ruby-value">0</span>

        <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">log_file</span>, <span class="ruby-value str">'r'</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">file</span>.<span class="ruby-identifier">readlines</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
            <span class="ruby-identifier">lines_read</span> = <span class="ruby-identifier">lines_read</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
            <span class="ruby-keyword kw">if</span>(<span class="ruby-identifier">lines_read</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lines_put</span>)
              <span class="ruby-keyword kw">if</span>(<span class="ruby-operator">!</span><span class="ruby-identifier">parse_test_result</span>(<span class="ruby-identifier">line</span>, <span class="ruby-identifier">thread</span>))
                <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;[trace] #{line}&quot;</span>
              <span class="ruby-keyword kw">end</span>
              <span class="ruby-identifier">$stdout</span>.<span class="ruby-identifier">flush</span>
              <span class="ruby-identifier">lines_put</span> = <span class="ruby-identifier">lines_put</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
            <span class="ruby-keyword kw">end</span>
          <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000317" class="method-detail">
        <a name="M000317"></a>

        <div class="method-heading">
          <a href="#M000317" class="method-signature">
          <span class="method-name">run</span><span class="method-args">(tool, gem_version, swf)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000317-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000317-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 245</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">run</span>(<span class="ruby-identifier">tool</span>, <span class="ruby-identifier">gem_version</span>, <span class="ruby-identifier">swf</span>)
      <span class="ruby-identifier">path_to_exe</span> = <span class="ruby-constant">Sprout</span>.<span class="ruby-identifier">get_executable</span>(<span class="ruby-identifier">tool</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">gem_version</span>)
      <span class="ruby-identifier">target</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">clean_path</span>(<span class="ruby-identifier">path_to_exe</span>)
      <span class="ruby-ivar">@player_pid</span> = <span class="ruby-keyword kw">nil</span>
      
      <span class="ruby-identifier">thread_out</span> = <span class="ruby-identifier">$stdout</span>
      <span class="ruby-identifier">command</span> = <span class="ruby-node">&quot;#{target} #{User.clean_path(swf)}&quot;</span>

      <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">new</span> {
        <span class="ruby-identifier">usr</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">new</span>()
        <span class="ruby-keyword kw">if</span>(<span class="ruby-identifier">usr</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">WinUser</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">usr</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">CygwinUser</span>))
          <span class="ruby-identifier">system</span> <span class="ruby-identifier">command</span>
        <span class="ruby-keyword kw">else</span>
          <span class="ruby-identifier">require</span> <span class="ruby-value str">'open4'</span>
          <span class="ruby-ivar">@player_pid</span>, <span class="ruby-identifier">stdin</span>, <span class="ruby-identifier">stdout</span>, <span class="ruby-identifier">stderr</span> = <span class="ruby-constant">Open4</span>.<span class="ruby-identifier">popen4</span>(<span class="ruby-identifier">command</span>)
          <span class="ruby-identifier">focus_player_on_mac</span>(<span class="ruby-identifier">thread_out</span>, <span class="ruby-identifier">path_to_exe</span>)
          <span class="ruby-identifier">stdout</span>.<span class="ruby-identifier">read</span>
        <span class="ruby-keyword kw">end</span>
      }
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000305" class="method-detail">
        <a name="M000305"></a>

        <div class="method-heading">
          <a href="#M000305" class="method-signature">
          <span class="method-name">swf</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000305-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000305-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 130</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">swf</span>
      <span class="ruby-ivar">@swf</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword kw">nil</span>
      <span class="ruby-keyword kw">if</span>(<span class="ruby-ivar">@swf</span>.<span class="ruby-identifier">nil?</span>)
        <span class="ruby-identifier">prerequisites</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">req</span><span class="ruby-operator">|</span>
          <span class="ruby-keyword kw">if</span>(<span class="ruby-identifier">req</span>.<span class="ruby-identifier">index</span>(<span class="ruby-value str">'.swf'</span>))
            <span class="ruby-ivar">@swf</span> = <span class="ruby-identifier">req</span>.<span class="ruby-identifier">to_s</span>
            <span class="ruby-keyword kw">break</span>
          <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@swf</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000304" class="method-detail">
        <a name="M000304"></a>

        <div class="method-heading">
          <a href="#M000304" class="method-signature">
          <span class="method-name">swf=</span><span class="method-args">(swf)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
The <a href="FlashPlayerTask.html#M000305">swf</a> parameter can be set
explicitly in the block sent to this task as in:
</p>
<pre>
  flashplayer :run do |t|
    t.swf = 'bin/SomeProject.swf'
  end
</pre>
<p>
Or it can be set implicitly as a rake prerequisite as follows:
</p>
<pre>
  flashplayer :run =&gt; 'bin/SomeProject' do |t|
  end
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000304-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000304-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 126</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">swf=</span>(<span class="ruby-identifier">swf</span>)
      <span class="ruby-ivar">@swf</span> = <span class="ruby-identifier">swf</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000314" class="method-detail">
        <a name="M000314"></a>

        <div class="method-heading">
          <a href="#M000314" class="method-signature">
          <span class="method-name">test_result</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000314-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000314-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 200</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_result</span>
      <span class="ruby-ivar">@test_result</span> <span class="ruby-operator">||=</span> <span class="ruby-value str">''</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000313" class="method-detail">
        <a name="M000313"></a>

        <div class="method-heading">
          <a href="#M000313" class="method-signature">
          <span class="method-name">test_result_file</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000313-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000313-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 196</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_result_file</span>
      <span class="ruby-ivar">@test_result_file</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@default_result_file</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000312" class="method-detail">
        <a name="M000312"></a>

        <div class="method-heading">
          <a href="#M000312" class="method-signature">
          <span class="method-name">test_result_file=</span><span class="method-args">(file)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
The File where JUnit test results should be written. This value defaults to
&#8216;AsUnitResults.xml&#8216;
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000312-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000312-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 192</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">test_result_file=</span>(<span class="ruby-identifier">file</span>)
      <span class="ruby-ivar">@test_result_file</span> = <span class="ruby-identifier">file</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000321" class="method-detail">
        <a name="M000321"></a>

        <div class="method-heading">
          <a href="#M000321" class="method-signature">
          <span class="method-name">write_test_result</span><span class="method-args">(result)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000321-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000321-source">
<pre>
<span class="ruby-comment cmt"># File bundles/flashplayer/lib/sprout/tasks/flashplayer_task.rb, line 325</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">write_test_result</span>(<span class="ruby-identifier">result</span>)
      <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">makedirs</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">test_result_file</span>))
      <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">test_result_file</span>, <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">CREAT</span><span class="ruby-operator">|</span><span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">TRUNC</span><span class="ruby-operator">|</span><span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">RDWR</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-identifier">result</span>)
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>